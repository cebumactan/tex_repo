# -*- coding: utf-8 -*-
import numpy as np

class Quad1d:
    def __init__(self,polydeg):
        self.nq = polydeg+1
        self.x = np.zeros(self.nq)
        self.w = np.zeros(self.nq)
    
        def deg1():    
            self.x[0] = 0.0;
            self.w[0] = 2.0;
        def deg2():
            self.x[0] = -0.577350269189626;
            self.x[1] =  0.577350269189626;
            self.w[0] =  1.0;
            self.w[1] =  1.0;
        def deg3():
            self.x[0] = -0.774596669241483;
            self.x[1] =  0.0;
            self.x[2] =  0.774596669241483;
            self.w[0] =  0.555555555555556;
            self.w[1] =  0.888888888888889;
            self.w[2] =  0.555555555555556;
        def deg4():
            self.x[0] = -0.861136311594053;
            self.x[1] = -0.339981043584856;
            self.x[2] =  0.339981043584856;
            self.x[3] =  0.861136311594053;
            self.w[0] =  0.347854845137454;
            self.w[1] =  0.652145154862546;
            self.w[2] =  0.652145154862546;
            self.w[3] =  0.347854845137454;
        def deg5():
            self.x[0] = -0.906179845938664;
            self.x[1] = -0.538469310105683;
            self.x[2] =  0.0;
            self.x[3] =  0.538469310105683;
            self.x[4] =  0.906179845938664;
            self.w[0] =  0.236926885056189;
            self.w[1] =  0.478628670499366;
            self.w[2] =  0.568888888888889;
            self.w[3] =  0.478628670499366;
            self.w[4] =  0.236926885056189;
        def deg6():
            self.x[0] = -0.932469514203152; 
            self.x[1] = -0.661209386466265; 
            self.x[2] = -0.238619186083197; 
            self.x[3] =  0.238619186083197;
            self.x[4] =  0.661209386466265; 
            self.x[5] =  0.932469514203152;
            self.w[0] =  0.171324492379170; 
            self.w[1] =  0.360761573048139; 
            self.w[2] =  0.467913934572691; 
            self.w[3] =  0.467913934572691;
            self.w[4] =  0.360761573048139; 
            self.w[5] =  0.171324492379170;
        def deg7():
            self.x[0] = -0.949107912342759;
            self.x[1] = -0.741531185599394;
            self.x[2] = -0.405845151377397;
            self.x[3] =  0.0;
            self.x[4] =  0.405845151377397;
            self.x[5] =  0.741531185599394;
            self.x[6] =  0.949107912342759;
            self.w[0] =  0.1294849661688697;
            self.w[1] =  0.2797053914892767;
            self.w[2] =  0.3818300505051189;
            self.w[3] =  0.4179591836734694;
            self.w[4] =  0.3818300505051189;
            self.w[5] =  0.2797053914892767;
            self.w[6] =  0.1294849661688697;
        def deg8():
            self.x[0] = -0.9602898564975362316835609;
            self.x[1] = -0.7966664774136267395915539;
            self.x[2] = -0.5255324099163289858177390;
            self.x[3] = -0.1834346424956498049394761;
            self.x[4] =  0.1834346424956498049394761;
            self.x[5] =  0.5255324099163289858177390;
            self.x[6] =  0.7966664774136267395915539;
            self.x[7] =  0.9602898564975362316835609;
            self.w[0] =  0.1012285362903762591525314;
            self.w[1] =  0.2223810344533744705443560;
            self.w[2] =  0.3137066458778872873379622;
            self.w[3] =  0.3626837833783619829651504;
            self.w[4] =  0.3626837833783619829651504;
            self.w[5] =  0.3137066458778872873379622;
            self.w[6] =  0.2223810344533744705443560;
            self.w[7] =  0.1012285362903762591525314;
        def deg9():
            self.x[0] = -0.9681602395076260898355762;
            self.x[1] = -0.8360311073266357942994298;
            self.x[2] = -0.6133714327005903973087020;
            self.x[3] = -0.3242534234038089290385380;
            self.x[4] =  0.0;
            self.x[5] =  0.3242534234038089290385380;
            self.x[6] =  0.6133714327005903973087020;
            self.x[7] =  0.8360311073266357942994298;
            self.x[8] =  0.9681602395076260898355762;
            self.w[0] =  0.0812743883615744119718922;
            self.w[1] =  0.1806481606948574040584720;
            self.w[2] =  0.2606106964029354623187429;
            self.w[3] =  0.3123470770400028400686304;
            self.w[4] =  0.3302393550012597631645251;
            self.w[5] =  0.3123470770400028400686304;
            self.w[6] =  0.2606106964029354623187429;
            self.w[7] =  0.1806481606948574040584720;
            self.w[8] =  0.0812743883615744119718922;
        def deg10():
            self.x[0] = -0.9739065285171717200779640;
            self.x[1] = -0.8650633666889845107320967;
            self.x[2] = -0.6794095682990244062343274;
            self.x[3] = -0.4333953941292471907992659;
            self.x[4] = -0.1488743389816312108848260;
            self.x[5] =  0.1488743389816312108848260;
            self.x[6] =  0.4333953941292471907992659;
            self.x[7] =  0.6794095682990244062343274;
            self.x[8] =  0.8650633666889845107320967;
            self.x[9] =  0.9739065285171717200779640;
            self.w[0] =  0.0666713443086881375935688;
            self.w[1] =  0.1494513491505805931457763;
            self.w[2] =  0.2190863625159820439955349;
            self.w[3] =  0.2692667193099963550912269;
            self.w[4] =  0.2955242247147528701738930;
            self.w[5] =  0.2955242247147528701738930;
            self.w[6] =  0.2692667193099963550912269;
            self.w[7] =  0.2190863625159820439955349;
            self.w[8] =  0.1494513491505805931457763;
            self.w[9] =  0.0666713443086881375935688;
        def deg11():
            self.x[0] = -0.9782286581460569928039380;
            self.x[1] = -0.8870625997680952990751578;
            self.x[2] = -0.7301520055740493240934163;
            self.x[3] = -0.5190961292068118159257257;
            self.x[4] = -0.2695431559523449723315320;
            self.x[5] = 0.0;
            self.x[6] = 0.2695431559523449723315320;
            self.x[7] = 0.5190961292068118159257257;
            self.x[8] = 0.7301520055740493240934163;
            self.x[9] = 0.8870625997680952990751578;
            self.x[10] = 0.9782286581460569928039380;
            self.w[0] = 0.0556685671161736664827537; 
            self.w[1] = 0.1255803694649046246346943; 
            self.w[2] = 0.1862902109277342514260976; 
            self.w[3] = 0.2331937645919904799185237; 
            self.w[4] = 0.2628045445102466621806889; 
            self.w[5] = 0.2729250867779006307144835; 
            self.w[6] = 0.2628045445102466621806889; 
            self.w[7] = 0.2331937645919904799185237; 
            self.w[8] = 0.1862902109277342514260976; 
            self.w[9] = 0.1255803694649046246346943; 
            self.w[10] = 0.0556685671161736664827537;
        def deg12():
            self.x[0] = -0.9815606342467192506905491;
            self.x[1] = -0.9041172563704748566784659;
            self.x[2] = -0.7699026741943046870368938;
            self.x[3] = -0.5873179542866174472967024;
            self.x[4] = -0.3678314989981801937526915;
            self.x[5] = -0.1252334085114689154724414;
            self.x[6] =  0.1252334085114689154724414;
            self.x[7] =  0.3678314989981801937526915;
            self.x[8] =  0.5873179542866174472967024;
            self.x[9] =  0.7699026741943046870368938;
            self.x[10] = 0.9041172563704748566784659;
            self.x[11] = 0.9815606342467192506905491;
            self.w[0] = 0.0471753363865118271946160;
            self.w[1] = 0.1069393259953184309602547;
            self.w[2] = 0.1600783285433462263346525;
            self.w[3] = 0.2031674267230659217490645;
            self.w[4] = 0.2334925365383548087608499;
            self.w[5] = 0.2491470458134027850005624;
            self.w[6] = 0.2491470458134027850005624;
            self.w[7] =  0.2334925365383548087608499;
            self.w[8] =  0.2031674267230659217490645;
            self.w[9] =  0.1600783285433462263346525;
            self.w[10] = 0.1069393259953184309602547;
            self.w[11] = 0.0471753363865118271946160;      

        xwfillin = {
            1:deg1,
            2:deg2,
            3:deg3,
            4:deg4,
            5:deg5,
            6:deg6,
            7:deg7,
            8:deg8,
            9:deg9,
            10:deg10,
            11:deg11,
            12:deg12
        }
        
        xwfillin[self.nq]() # fill in quadrature points
        
        # Adjust the points and weights in [0,1] */
        for i in range(0,self.nq):
            self.x[i] = 0.5*self.x[i] + 0.5
            self.w[i] = 0.5*self.w[i]

# integrate polynomial from a to b. kn[k] is coefficient of x^k
    def myintegral(self,kn,a,b): 
        mysum = 0
        for n in range(0,self.nq):
            polyvalue = 0
            for k in range(0,np.size(kn)):
                polyvalue+= kn[k]*( ( (b-a)*self.x[n] + a )**k ) 
            mysum+=self.w[n]*polyvalue
        mysum = mysum*(b-a)
        return mysum




